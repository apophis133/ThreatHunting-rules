rule Powershell_Scripts_for_Hackers_and_Pentesters
{
    meta:
        description = "Detection patterns for the tool 'Powershell-Scripts-for-Hackers-and-Pentesters' taken from the ThreatHunting-Keywords github project" 
        author = "@mthcht"
        reference = "https://github.com/mthcht/ThreatHunting-Keywords"
        tool = "Powershell-Scripts-for-Hackers-and-Pentesters"
        rule_category = "offensive_tool_keyword"

    strings:
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string1 = /\sall_in_one_enum\.ps1/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string2 = /\sdll\-installer\.ps1/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string3 = /\sSendScreenshotToTelegram/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string4 = /\swin\-key\-killer\.ps1/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string5 = /\"HEHE\sYOU\sHAVE\sBEEN\sPWENED\"/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string6 = /\#CODED\sBY\sSMUKX/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string7 = /\$env\:TEMP\\winkeykey\.txt/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string8 = /\/all_in_one_enum\.ps1/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string9 = /\/dll\-installer\.ps1/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string10 = /\/keylog\.exe/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string11 = /\/master\/windows\/klog_main\.cpp/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string12 = /\/Powershell\-Scripts\-for\-Hackers\-and\-Pentesters/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string13 = /\/win\-key\-killer\.ps1/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string14 = /\\all_in_one_enum\.ps1/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string15 = /\\dll\-installer\.ps1/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string16 = /\\keylog\.cpp/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string17 = /\\keylog\.exe/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string18 = /\\keylogger\.txt/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string19 = /\\Powershell\-Scripts\-for\-Hackers\-and\-Pentesters/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string20 = /\\trix\-back\-gen\.zip/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string21 = /\\win\-key\-killer\.ps1/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string22 = /0d773444d899ab08f8aaee56dec0fb17928784dca205ef25af61a71bf4fb6e3f/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string23 = /216244b421d1ebb05ea81496831a2893139d6e2329db77e39cd6a2dc08e703e8/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string24 = /33b54c9b555472d471ff2eb145156d7212e13ad4282b020527267ca42c2afafe/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string25 = /3dca957edf214b435721c18bbacef52a660d618150453589bd95631eb92b5cc8/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string26 = /4a613d768611d513d39de2212129c8fe56b77c016b0818584a3ca3cfd6a9bcaf/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string27 = /50C0BF9479EFC93FA9CF1AA99BD\?CA923273B71A1/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string28 = /5b5f70992a0d5a59176a7bfb43401d56ab3d250958378f1d913405040bf7cf54/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string29 = /9CD\?F6D5878FC3AECF10761FD72371A2877F270D0/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string30 = /9D1C563E5228B2572F5CA14F0EC33\?CA0DEDA3D57/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string31 = /a287b6d1ff18dab39efbf0b4c6937507f388923cbb47e66d72938aa87912bc20/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string32 = /b5cbcd477e65b4fad4c55e22043eda8859bab60bbdaad28386cf5a70f04299cd/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string33 = /B948E25D061039D64115CFDE74D2FF4372E83765/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string34 = /bWFsd2FyZQ\=\=/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string35 = /cc5b8ca570f2f1aa9aed761a466007e7bd4b807f823e5add1d10fb732a034e9c/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string36 = /d3a7210d3999176aaea1f64927668d443bffbd764fe113e2869b1ad03c2d3013/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string37 = /D3DF3F32716042404798E3E9D691ACED2F78BD\?D5/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string38 = /download\skeylog\.exe/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string39 = /e803b7023dfdcb1d73de9a04be5222269b020ada4fcc97ca19ef877c55a51c28/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string40 = /EC54E\?F8D79BF30B63C5249AF7A8A3C652595B923/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string41 = /f572574e8f466040330510743d57e07ac795ed8caa62856f3efd2bff4f69793d/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string42 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_BIOS\"/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string43 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_ComputerSystem\"\s\-PropertyFilter\sUserName/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string44 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_ComputerSystem\"/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string45 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_Desktop\"/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string46 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_LocalTime\"/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string47 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_LogicalDisk\"\s\-PropertyFilter\sDeviceID\,DriveType\,ProviderName\,VolumeName\,Size\,FreeSpace\,PSComputerName/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string48 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_LogonSession\"/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string49 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_OperatingSystem\"\s\-PropertyFilter\sBuild.{0,1000}\,OSType\,ServicePack.{0,1000}/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string50 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_OperatingSystem\"\s\-PropertyFilter\suser/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string51 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_Processor\"\s\-PropertyFilter\s.{0,1000}/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string52 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_QuickFixEngineering\"\s\-PropertyFilter\sHotFixId/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string53 = /Get\-AndDisplayInformation\s\-ClassName\s\"Win32_Service\"\s\-PropertyFilter\sStatus\,Name\,DisplayName/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string54 = /HEHE\s\-\sYOU\sHAVE\sBEEN\sPWENED/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string55 = /InvokeReflectivePEInjection/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string56 = /Invoke\-ReflectivePEInjection/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string57 = /kerberos\:\:golden\s.{0,1000}\.kirbi/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string58 = /Payload\-Generator\/trix\-back\-gen\.zip/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string59 = /scp\s\-P\s.{0,1000}system_info\.txt/ nocase ascii wide
        // Description: 
        // Reference: https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters
        $string60 = /smukx\@proton\.me/ nocase ascii wide

    condition:
        any of them
}
