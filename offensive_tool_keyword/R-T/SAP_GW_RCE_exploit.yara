rule SAP_GW_RCE_exploit
{
    meta:
        description = "Detection patterns for the tool 'SAP_GW_RCE_exploit' taken from the ThreatHunting-Keywords github project" 
        author = "@mthcht"
        reference = "https://github.com/mthcht/ThreatHunting-Keywords"
        tool = "SAP_GW_RCE_exploit"
        rule_category = "offensive_tool_keyword"

    strings:
        // Description: This PoC exploits an ACL misconfiguration in the SAP Gateway (port 33xx) that leads to a Remote Command Execution (RCE).SAPanonGWv1.py is the first version of the exploit based on raw packets sent. It does not require any additional modules (Run and Pwn!) SAPanonGWv2.py is the second version of the exploit based on the pysap library
        // Reference: https://github.com/chipik/SAP_GW_RCE_exploit
        $string1 = /SAP_GW_RCE_exploit/ nocase ascii wide

    condition:
        any of them
}
